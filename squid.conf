# Configuración del puerto con soporte SSL-Bump
http_port 3128 intercept ssl-bump cert=/usr/local/squid3/etc/site_priv+pub.pem key=/usr/local/squid3/etc/site_priv+pub.key

# Configuración básica
visible_hostname squid-proxy
cache deny all
access_log stdio:/var/log/squid/access.log
http_access allow all

# Configuración de SSL-Bump
acl step1 at_step SslBump1
ssl_bump peek step1
ssl_bump bump all

# Opciones de proxy SSL
sslproxy_cert_error allow all
sslproxy_flags DONT_VERIFY_PEER
sslproxy_options ALL
sslproxy_cipher EXP:MEDIUM:LOW:!aNULL:!MD5

# Generación de certificados SSL dinámicos
sslcrtd_program /usr/lib/squid/security_file_certgen -s /var/spool/squid_ssldb -M 4MB
sslcrtd_children 10

# Registro de claves SSL para descifrado en Wireshark
sslproxy_log /var/log/squid/sslproxy.log
sslproxy_session_cache_size 10 MB
sslproxy_session_cache_timeout 60